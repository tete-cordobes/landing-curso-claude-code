<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Gesti√≥n de Blog | Curso Claude Code</title>
    <meta name="robots" content="noindex, nofollow">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" href="/claude-color.png">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#3b82f6">

    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="admin-styles.css">
</head>
<body class="admin-body">
    <!-- Admin Header -->
    <header class="admin-header">
        <div class="admin-container">
            <div class="admin-header-content">
                <div class="admin-logo">
                    <img src="claude-color.png" alt="Logo" width="32" height="32" loading="eager">
                    <span>Dashboard Admin</span>
                </div>
                <div class="admin-user">
                    <span id="adminUsername"></span>
                    <button onclick="logout()" class="btn-logout">Cerrar Sesi√≥n</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Admin Main -->
    <main class="admin-main">
        <div class="admin-container">
            <!-- Tabs -->
            <div class="admin-tabs">
                <button class="admin-tab active" onclick="showTab('posts')">üìù Posts</button>
                <button class="admin-tab" onclick="showTab('new')">‚ûï Nuevo Post</button>
                <button class="admin-tab" onclick="showTab('settings')">‚öôÔ∏è Configuraci√≥n</button>
            </div>

            <!-- Tab: Posts List -->
            <div id="postsTab" class="admin-tab-content active">
                <div class="admin-section-header">
                    <h2>Todos los Posts</h2>
                    <button onclick="showTab('new')" class="btn-primary-admin">+ Crear Nuevo Post</button>
                </div>

                <div id="postsListContainer" class="posts-list">
                    <!-- Posts will be loaded here -->
                </div>

                <div id="noPostsMessage" class="no-data" style="display: none;">
                    <div class="no-data-icon">üìù</div>
                    <h3>No hay posts todav√≠a</h3>
                    <p>Crea tu primer post para empezar</p>
                    <button onclick="showTab('new')" class="btn-primary-admin">Crear Primer Post</button>
                </div>
            </div>

            <!-- Tab: New/Edit Post -->
            <div id="newTab" class="admin-tab-content">
                <div class="admin-section-header">
                    <h2 id="formTitle">Crear Nuevo Post</h2>
                    <button onclick="cancelEdit()" class="btn-secondary-admin">Cancelar</button>
                </div>

                <form id="postForm" class="post-form">
                    <input type="hidden" id="postId">

                    <div class="form-row">
                        <div class="form-group-admin">
                            <label for="postTitleInput">T√≠tulo del Post *</label>
                            <input
                                type="text"
                                id="postTitleInput"
                                placeholder="Ej: 10 Comandos Esenciales de Claude Code"
                                required
                            >
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group-admin">
                            <label for="postSlug">URL del Post (slug) *</label>
                            <input
                                type="text"
                                id="postSlug"
                                placeholder="Ej: 10-comandos-claude-code"
                                required
                            >
                            <small>Se usar√° como: post-template.html?slug=tu-slug</small>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group-admin">
                            <label for="postExcerptInput">Extracto / Descripci√≥n *</label>
                            <textarea
                                id="postExcerptInput"
                                rows="3"
                                placeholder="Breve descripci√≥n que aparecer√° en el listado y en meta description"
                                required
                            ></textarea>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group-admin">
                            <label for="postImageInput">URL de la Imagen</label>
                            <input
                                type="url"
                                id="postImageInput"
                                placeholder="https://ejemplo.com/imagen.jpg"
                            >
                        </div>
                        <div class="form-group-admin">
                            <label for="postReadingTimeInput">Tiempo de lectura</label>
                            <input
                                type="text"
                                id="postReadingTimeInput"
                                placeholder="5 min de lectura"
                            >
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group-admin full-width">
                            <label for="postContentInput">Contenido del Post (HTML permitido) *</label>
                            <textarea
                                id="postContentInput"
                                rows="15"
                                placeholder="Escribe el contenido en HTML o texto plano..."
                                required
                            ></textarea>
                            <small>Puedes usar HTML: &lt;h2&gt;, &lt;h3&gt;, &lt;p&gt;, &lt;ul&gt;, &lt;li&gt;, &lt;strong&gt;, &lt;code&gt;, etc.</small>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-primary-admin btn-large">
                            <span id="submitBtnText">Publicar Post</span>
                        </button>
                        <button type="button" onclick="cancelEdit()" class="btn-secondary-admin">Cancelar</button>
                    </div>
                </form>
            </div>

            <!-- Tab: Settings -->
            <div id="settingsTab" class="admin-tab-content">
                <div class="admin-section-header">
                    <h2>Configuraci√≥n</h2>
                </div>

                <div class="settings-section">
                    <h3>Configuraci√≥n de GitHub</h3>
                    <p>Configura tu token de GitHub para poder crear, editar y eliminar posts. Los posts se guardar√°n directamente en tu repositorio.</p>
                    <form id="githubTokenForm" class="credentials-form">
                        <div class="form-group-admin">
                            <label for="githubToken">Token de GitHub (Personal Access Token)</label>
                            <input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxx">
                            <small style="display: block; margin-top: 0.5rem; color: #718096;">
                                <strong>C√≥mo crear tu token:</strong><br>
                                1. Ve a GitHub ‚Üí Settings ‚Üí Developer settings ‚Üí Personal access tokens ‚Üí Tokens (classic)<br>
                                2. Genera un nuevo token con permisos: <code>repo</code> (acceso completo al repositorio)<br>
                                3. Copia el token y p√©galo aqu√≠
                            </small>
                        </div>
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <button type="submit" class="btn-primary-admin">Guardar Token</button>
                            <span id="tokenStatus" style="color: #718096; font-size: 0.875rem;"></span>
                        </div>
                    </form>
                    <div id="githubTokenInfo" style="margin-top: 1rem; padding: 1rem; background: #f7fafc; border-radius: 8px; display: none;">
                        <p style="margin: 0; color: #2d3748;">
                            <strong>‚úÖ Token configurado</strong><br>
                            <span id="githubUsername" style="color: #718096;"></span>
                        </p>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Generador de Sitemap</h3>
                    <p>Genera un sitemap.xml actualizado con todas las p√°ginas y posts del blog para mejorar el SEO.</p>
                    <button onclick="generateSitemap()" class="btn-primary-admin">üó∫Ô∏è Generar Sitemap.xml</button>
                    <div id="sitemapPreview" style="display: none; margin-top: 1rem;">
                        <label style="font-weight: 600; display: block; margin-bottom: 0.5rem;">Vista previa del sitemap:</label>
                        <textarea id="sitemapContent" readonly style="width: 100%; height: 300px; font-family: monospace; font-size: 0.875rem; padding: 1rem; border: 2px solid #e2e8f0; border-radius: 8px;"></textarea>
                        <div style="margin-top: 1rem; display: flex; gap: 1rem;">
                            <button onclick="downloadSitemap()" class="btn-primary-admin">üíæ Descargar sitemap.xml</button>
                            <button onclick="copySitemap()" class="btn-secondary-admin">üìã Copiar al portapapeles</button>
                        </div>
                        <small style="color: #718096; display: block; margin-top: 0.5rem;">
                            üìù Nota: Descarga el archivo y s√∫belo manualmente a tu repositorio GitHub para reemplazar el sitemap.xml existente.
                        </small>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Cambiar Credenciales de Acceso</h3>
                    <form id="credentialsForm" class="credentials-form">
                        <div class="form-group-admin">
                            <label for="newUsername">Nuevo Usuario</label>
                            <input type="text" id="newUsername" placeholder="Usuario actual o nuevo">
                        </div>
                        <div class="form-group-admin">
                            <label for="newPassword">Nueva Contrase√±a</label>
                            <input type="password" id="newPassword" placeholder="Nueva contrase√±a">
                        </div>
                        <div class="form-group-admin">
                            <label for="confirmPassword">Confirmar Contrase√±a</label>
                            <input type="password" id="confirmPassword" placeholder="Confirma la contrase√±a">
                        </div>
                        <button type="submit" class="btn-primary-admin">Actualizar Credenciales</button>
                    </form>
                </div>

                <div class="settings-section danger-zone">
                    <h3>Zona Peligrosa</h3>
                    <p>Estas acciones no se pueden deshacer</p>
                    <button onclick="deleteAllPosts()" class="btn-danger">Eliminar Todos los Posts</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script src="github-api.js"></script>
    <script src="admin.js"></script>
</body>
</html>
